# Semantic Diff: 336926a2

**Commit:** `336926a2944c652a7305d4ecc95d937336f28e8d`
**Author:** mvyshhnyvetska <t.kenaz@gmail.com>
**Date:** 2026-01-21T09:31:09+01:00

> feat: open source release preparation

- Add MIT LICENSE
- Add CONTRIBUTING.md with dev guidelines
- Add TODO.md roadmap (5 phases)
- Add GitHub Action (action.yml) for PR analysis
- Add CI workflow (lint, test, self-analysis)
- Add release workflow (PyPI + GitHub releases)
- Add MarkdownFormatter + --save flag for reports

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

## üìÅ Files Changed

| File | Change | + | - | Lang |
|------|--------|---|---|------|
| `.github/workflows/ci.yml` | added | 122 | 0 | yaml |
| `.github/workflows/release.yml` | added | 38 | 0 | yaml |
| `CONTRIBUTING.md` | added | 105 | 0 | markdown |
| `LICENSE` | added | 21 | 0 | - |
| `TODO.md` | added | 143 | 0 | markdown |
| `action.yml` | added | 196 | 0 | yaml |
| `semantic_diff/cli.py` | modified | 16 | 1 | python |
| `semantic_diff/formatters/markdown_formatter.py` | added | 135 | 0 | python |

## üéØ Intent

**Prepare the semantic-diff project for public open source release by adding complete project infrastructure including licensing, contribution guidelines, CI/CD automation, and GitHub Action integration to enable community adoption and dogfooding.**

This commit transforms a private/internal tool into a public open source project. The addition of MIT LICENSE, CONTRIBUTING.md, comprehensive CI workflows, PyPI release automation, and a GitHub Action manifest (action.yml) are all standard open source release prerequisites. The TODO.md roadmap explicitly mentions 'Open Source Roadmap' and the CI workflow includes a 'dogfooding' feature where semantic-diff analyzes itself. The MarkdownFormatter addition supports better report generation for GitHub integration.

*Confidence: 95%*

## üó∫Ô∏è Impact Map

### Direct Impacts
- ‚ö° **Public API surface**: CLI now exposes --save flag and markdown output format, creating a new contract with users who will depend on this interface
- ‚ö†Ô∏è **CI/CD pipeline**: Automated workflows will now run on every PR and tag push, consuming GitHub Actions minutes and requiring ANTHROPIC_API_KEY secret configuration
- ‚ö° **Distribution**: Package will be published to PyPI on version tags, making it globally installable and creating expectations for semantic versioning
- üî• **GitHub Action ecosystem**: action.yml makes this tool usable as a reusable action in other repositories, creating external dependencies on API stability

### Indirect Impacts
- ‚ö° **API rate limits and costs**: Self-analysis on every PR and external action usage will increase Anthropic API consumption; no budget controls visible in code
- ‚ö†Ô∏è **Security surface**: ANTHROPIC_API_KEY must now be managed as GitHub secret across repositories using the action; key leakage could occur if users misconfigure
- ‚ö†Ô∏è **Maintenance burden**: Public release creates implicit commitment to respond to issues, maintain backward compatibility, and support community contributions
- ‚úì **Documentation coherence**: Multiple documentation files (README, CONTRIBUTING, TODO, action.yml) must stay synchronized as features evolve

**Affected Components:** semantic_diff/cli.py, semantic_diff/formatters/, .github/workflows/, PyPI distribution, GitHub Marketplace, External CI pipelines using the action

## ‚ö†Ô∏è Risk Assessment

**Overall Risk:** ‚ö° HIGH

### Identified Risks

#### ‚ö° [high] GitHub Action fails on non-PR events due to missing PR context in action.yml steps.commits logic (line 65-74)
- üí° **Mitigation:** Add explicit handling for push events and test action on both event types; validate github.event.pull_request exists before accessing nested properties
- ‚ö° **Edge cases:** Push to branch without PR, Manual workflow dispatch, Workflow run on forked repository without secrets

#### üî• [critical] Self-analysis in ci.yml will fail on forks without ANTHROPIC_API_KEY secret, blocking external contributions
- üí° **Mitigation:** Make semantic-analysis job conditional on secret availability using 'if: secrets.ANTHROPIC_API_KEY != null' or allow forks to skip this job
- ‚ö° **Edge cases:** First-time contributor fork, Dependabot PRs, PRs from organization members without secret access

#### ‚ö° [high] Release workflow uses PyPI trusted publishing but pyproject.toml configuration for trusted publisher not visible in diff
- üí° **Mitigation:** Verify PyPI project is configured for GitHub OIDC trusted publishing before tagging; document setup steps in CONTRIBUTING.md
- ‚ö° **Edge cases:** First release attempt will fail if PyPI not configured, Tag push triggers release before manual verification

#### ‚ö†Ô∏è [medium] MarkdownFormatter escaping and injection vulnerabilities if commit messages contain malicious markdown/HTML
- üí° **Mitigation:** Audit MarkdownFormatter.py for proper escaping of user-controlled content (commit messages, file paths, diff content)
- ‚ö° **Edge cases:** Commit message with embedded script tags, File path with markdown link syntax, XSS in saved markdown reports viewed in unsafe renderers

#### ‚úì [low] CLI --save flag without documented output path could cause confusion or file conflicts
- üí° **Mitigation:** Document default save location in --help text and CONTRIBUTING.md; consider adding --output-dir flag
- ‚ö° **Edge cases:** Multiple users running tool in shared directory, CI artifacts collision, Gitignored reports directory not created

#### ‚ö†Ô∏è [medium] action.yml truncated in diff - full validation not possible, potential syntax errors or incomplete step definitions
- üí° **Mitigation:** Validate complete action.yml with actionlint tool; test action end-to-end in test repository before release
- ‚ö° **Edge cases:** Missing required inputs, Invalid shell commands in truncated section, Incorrect output variable references

## ‚ùì Review Questions

### 1. How will the self-analysis CI job handle PRs from forks that don't have access to ANTHROPIC_API_KEY secret? This will block all external contributions.
üî• Line 71 in ci.yml requires the secret but forks can't access repository secrets by default. This is a common blocker for open source projects.

### 2. Has the PyPI project been configured for trusted publishing with GitHub OIDC? The release workflow will fail silently without prior setup.
‚ö° Release workflow uses pypa/gh-action-pypi-publish@release/v1 with id-token: write, which requires PyPI side configuration. This is one-time manual setup that should be documented.

### 3. What is the expected API cost impact of running self-analysis on every PR? Is there a budget alert configured?
‚ö° The dogfooding feature is excellent for testing, but analyzing every commit with Claude could become expensive at scale. Consider adding cost estimates or rate limiting.

### 4. Why is the action.yml diff truncated? Are there additional steps we should review for security or correctness?
‚ö° The action.yml file shows '... (truncated - 2 more files)' at line 117, suggesting incomplete visibility into the action's full implementation. This is security-sensitive code that runs in user repositories.

### 5. Does MarkdownFormatter.py properly escape user-controlled content (commit messages, file paths) to prevent markdown injection in saved reports?
‚ö†Ô∏è The formatter generates markdown files from git data which is user-controlled. If these reports are viewed in contexts that render HTML, XSS could be possible.

### 6. Where does the --save flag write reports, and is this path documented? How are filename collisions handled?
‚ö†Ô∏è CLI change adds --save but the destination isn't visible in the diff. Users need to know where files go, and CI environments need predictable paths for artifact upload.

### 7. Is there a test that validates the GitHub Action works on both pull_request and push events?
‚ö†Ô∏è The action.yml has conditional logic for detecting event types (line 63-74). This should be integration tested to prevent runtime failures in user repositories.

### 8. How will you handle the maintenance burden of supporting users once this is public? Is there a support plan or SLA?
‚úì TODO.md mentions 'Response time SLA for issues' but this is a significant commitment for a small team. Consider clearly communicating best-effort support to manage expectations.

---
*Analysis by claude-sonnet-4-5-20250929 | 8,121 tokens | 2026-01-21T09:32:11.034867*